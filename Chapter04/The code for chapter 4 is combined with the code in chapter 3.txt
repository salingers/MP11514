The code for chapter 4 is combined with the code in chapter 3